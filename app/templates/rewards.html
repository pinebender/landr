{% extends "layout.html" %}
{% block content %}

<!-- Show available unclaimed rewards -->

<div class="row">
	<div class="col-md-12 col-xs-12 col-sm-12">
		<h2>Rewards: <button type="button" class="btn btn-default btn-sm" id="showaddform">Add Reward</button></h2>
		<table class="rewardlist">
			<tr class="rlheaders">
				<td>Title</td>
				<td>Description</td>
				<td>Cost</td>
				<td>Date Added</td>
			</tr>
		{% for reward in rewards %}
			{% if reward.cost <= points %}
			<tr>
				<td>{{ reward.title }}</td>
				<td>{{ reward.body|safe }}</td>
				<td>{{ reward.cost }}</td>
				<td>{{ reward.dateadded.strftime('%b, %d, %Y') }}</td>
				<td class="colcontrols">
					<form method='post' action='/redeem' id='redeemreward{{reward.id}}'></form>
					
						<input type='hidden' name='redeemrewardid' value='{{ reward.id }}' form='redeemreward{{reward.id}}'>
						<button type='submit' class='btn btn-default btn-xs taskcontrols' form='redeemreward{{reward.id}}'>Redeem</button>
				</td>
				<td class="colcontrols">
					<form method='post' action='/deletereward' id='deletereward{{reward.id}}'></form>
						<input type='hidden' name='deleterewardid' value='{{ reward.id }}' form='deletereward{{reward.id}}'>
						<button type='submit' class='btn btn-danger btn-xs taskcontrols' form='deletereward{{reward.id}}'>Delete</button>
				</td>
			</tr>
			{% endif %}
		{% endfor %}
		{% for reward in rewards %}
			{% if reward.cost > points %}
				<tr>
					<td>{{ reward.title }}</td>
					<td>{{ reward.body|safe }}</td>
					<td>{{ reward.cost }}</td>
					<td>{{ reward.dateadded.strftime('%b, %d, %Y') }}</td>
					<td class="colcontrols"></td>
					<td class="colcontrols">		
						<form method='post' action='/deletereward' id='deletereward{{reward.id}}'></form>
							<input type='hidden' name='deleterewardid' value='{{ reward.id }}' form='deletereward{{reward.id}}'>
							<button type='submit' class='btn btn-danger btn-xs taskcontrols' form='deletereward{{reward.id}}'>Delete</button>
					</td>
				</tr>
			{% endif %}
		{% endfor %}
		</table>
	</div>
</div>

{% if redeemed|length > 0 %}
<div class="row">
	<div class="col-md-12 col-sm-12 col xs-12">
		<h2>Redeemed Rewards:</h2>
		<table class="rewardlist">
			<tr class="rlheaders">
				<td>Title</td>
				<td>Description</td>
				<td>Cost</td>
				<td>Date Added</td>
			</tr>
		{% for reward in redeemed %}
			<tr>
				<td>{{ reward.title }}</td>
				<td>{{ reward.body|safe }}</td>
				<td>{{ reward.cost }}</td>
				<td>{{ reward.dateadded.strftime('%b, %d, %Y') }}</td>
				<td class="colcontrols"></td>
				<td class="colcontrols">
					<form method='post' action='/deletereward' id='deletereward{{reward.id}}'></form>
						<input type='hidden' name='deleterewardid' value='{{ reward.id }}' form='deletereward{{reward.id}}'>
						<button type='submit' class='btn btn-danger btn-xs taskcontrols' form='deletereward{{reward.id}}'>Delete</button>
				</td>
			</tr>
		{% endfor %}
		</table>
	</div>
</div>
{% endif %}
<!-- Add form -->
<div class="row" style="margin-top:20px">
	<div class ="col-md-8 col-sm-8 col-xs-8">
		<div id="addform" style="display:none;">
			<h3>Add a New Reward</h3>
			<form id="addreward" method="post" action="/rewards">
				<h3>Title:</h3>
				<textarea rows="1" cols="50" name="title" form="addreward" placeholder="Title" maxlength="75" required></textarea>
				<h3>Description:</h3>
				<textarea rows="5" cols="50" name="body" form="addreward" placeholder="Describe your reward!" maxlength="300"></textarea>
				<h3>Cost:</h3>
				<input type="number" name="cost" form="addreward" placeholder="1" maxlength="3" id="cost"><br/>
			</form>
		</div>
		<div class="submitbutton">
			<button type="submit" class="btn btn-default btn-sm" form="addreward" id="submitbutton" style="display: none; margin-right: 5px;">Submit</button>
			<button type="button" class="btn btn-default btn-sm" id="cancelbutton" style="display:none">Cancel</button>
		</div>
	</div>
</div>

{% endblock %}